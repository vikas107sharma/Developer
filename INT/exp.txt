
############################################  EVENT DRIVEN ARCHITECTURE  ############################################

[QUESTION 1]
Suppose multiple events are produced for the same order (OrderPlaced, OrderShipped, OrderDelivered). Consumers must process them in order. How would you ensure ordering in a distributed event-driven system? What trade-offs exist between ordering guarantees and scalability?


[ANSWER]

Ensuring Ordering

Partitioning by Key: Use a message broker/streaming platform (Kafka, Kinesis, Pulsar) and partition events by an identifier like order_id. All events for the same order go to the same partition → consumers process them in order.

Single Consumer per Partition: Ensure only one consumer reads a partition at a time (or uses consumer groups with one consumer per partition) to preserve order.

Idempotent Consumers: Even with ordering, make consumers idempotent so retries or replays don’t break consistency.

Sequencing Info: Include sequence numbers or timestamps in events for verification.


[QUESTION 2]

Report download
If generating a report takes ~15 minutes, a normal request/response API would timeout and the user would likely reload the page. How would you design the report download flow so it runs asynchronously (background job, status tracking, notification) and still gives the user a good experience?


#############################################  API LIMIT  ##########################################################


When a user updates their profile, we currently call an external API to send an email notification. In production, thousands of users may update their profiles at the same time, but the external API can handle only 200 requests per minute. How would you design this system to handle high traffic without breaching the API limit?


#############################################  SQL  ##########################################################

[QUESTION 1]
emails = [...]
for e of emails:
  update(pincode) where email = e
This causes one DB update per email. How would you optimize this to handle thousands of emails efficiently?

[QUESTION 2]
We have a log table that keeps growing rapidly. How would you design a solution to automatically remove records older than 30 days to prevent the database from growing too large?



#############################################  DESIGN  ##########################################################

[QUESTION 1]
Design a nested comment sections where user can to a comment.



#############################################  END  ##########################################################

2. Caching Strategy for Frequently Updated, Expensive Aggregations
Scenario: A UI must display the "Top 10 Most Searched Products," refreshed hourly. The data comes from a backend API that runs a complex, heavy SQL query with multiple joins to calculate these rankings on-the-fly.

Challenge: This heavy query is too slow and resource-intensive to run every time a user loads the UI.

How would you design a system to serve this data quickly and reliably?

What caching mechanism would you use (e.g., in-memory cache like Redis, database materialized view)?

How would you handle the cache invalidation and refresh every hour?

How does this design decouple the expensive processing from the user-facing request?

8. System Design (Rate Limiting & Scalability)
Scenario: You have a critical but expensive API endpoint that performs a complex calculation. A single bad actor or a misconfigured client could send a high volume of requests, overwhelming the service and causing a Denial-of-Service (DoS) for legitimate users.

Challenge: How do you protect your service and ensure its availability?

At what levels can you implement rate limiting (e.g., API Gateway, application logic, a dedicated service)?

What algorithm would you use for rate limiting (e.g., Token Bucket, Leaky Bucket, Fixed Window) and what are its advantages?

How would you make the rate limiting scalable and shared across multiple instances of your application?

What should the API response be to a rate-limited request?