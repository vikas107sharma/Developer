ğŸ”¹ Python

Q1: Write a Python function that takes a list of JSON objects and returns only those with status="active".
(Tests list comprehension, JSON parsing)

ğŸ”¹ Kafka

Q2: Write a Python Kafka producer that publishes 5 JSON messages to a topic named test_topic.
(Tests Kafka producer basics)

Q3: Write a Python Kafka consumer that prints messages from test_topic and stops after 5 messages.
(Tests consumer basics)

ğŸ”¹ AWS Lambda

Q4: Write a simple Python Lambda handler that receives an event with {"name": "John"} and returns "Hello John".
(Tests Lambda handler structure)

ğŸ”¹ Redis

Q5: Write Python code that sets a key in Redis with TTL=10 seconds, retrieves it, and prints â€œexpiredâ€ if the key no longer exists.
(Tests Redis set/get/TTL)

ğŸ”¹ Celery

Q6: Create a Celery task that adds two numbers and call it asynchronously, printing the result when ready.
(Tests Celery task basics)

Q7: Write a Celery task that retries up to 3 times if it raises an exception.
(Tests retry handling)

ğŸ”¹ Docker

Q8: Write a simple Dockerfile to run a Python script called app.py.
(Tests basic Dockerfile writing)

ğŸ”¹ Combined Mini Tasks

Q9: Create a Python script that reads a CSV file, caches its contents in Redis, and retrieves it on the next run.
(Tests Python file I/O + Redis caching)

Q10: Write a Python function triggered by an AWS Lambda event to store data into Redis.
(Tests AWS + Redis integration logic)








--------------------------------- ANSWER ---------------------------------

ğŸ”¹ Q1 Python (filter active)
data = [
    {"id": 1, "status": "active"},
    {"id": 2, "status": "inactive"},
    {"id": 3, "status": "active"}
]

def filter_active(items):
    return [item for item in items if item.get("status") == "active"]

print(filter_active(data))
# [{'id': 1, 'status': 'active'}, {'id': 3, 'status': 'active'}]

ğŸ”¹ Q2 Kafka Producer
from kafka import KafkaProducer
import json

producer = KafkaProducer(
    bootstrap_servers='localhost:9092',
    value_serializer=lambda v: json.dumps(v).encode('utf-8')
)

for i in range(5):
    producer.send('test_topic', {"id": i, "msg": f"hello {i}"})

producer.flush()
print("5 messages sent")

ğŸ”¹ Q3 Kafka Consumer
from kafka import KafkaConsumer
import json

consumer = KafkaConsumer(
    'test_topic',
    bootstrap_servers='localhost:9092',
    value_deserializer=lambda x: json.loads(x.decode('utf-8')),
    auto_offset_reset='earliest'
)

for idx, msg in enumerate(consumer):
    print(msg.value)
    if idx == 4:
        break
consumer.close()

ğŸ”¹ Q4 AWS Lambda Handler
def lambda_handler(event, context):
    name = event.get("name", "World")
    return {"message": f"Hello {name}"}

ğŸ”¹ Q5 Redis with TTL
import redis
import time

r = redis.Redis(host='localhost', port=6379, db=0)

r.set('key1', 'value1', ex=10)
print("Stored:", r.get('key1'))

time.sleep(11)
value = r.get('key1')
if value is None:
    print("expired")
else:
    print("Still there:", value)

ğŸ”¹ Q6 Celery Add Task

tasks.py:

from celery import Celery

app = Celery('demo', broker='redis://localhost:6379/0')

@app.task
def add(x, y):
    return x + y


run.py:

from tasks import add

result = add.delay(5, 7)
print("Task sent. Waiting for result...")
print(result.get(timeout=10))  # 12

ğŸ”¹ Q7 Celery Retry Task
from celery import Celery
app = Celery('demo', broker='redis://localhost:6379/0')

@app.task(bind=True, max_retries=3)
def flaky_task(self):
    import random
    if random.random() < 0.5:
        raise self.retry(countdown=2)
    return "Success!"

ğŸ”¹ Q8 Dockerfile for app.py
FROM python:3.11-slim

WORKDIR /app
COPY app.py /app

CMD ["python", "app.py"]

ğŸ”¹ Q9 CSV + Redis Cache
import csv, redis, json, os

r = redis.Redis(host='localhost', port=6379, db=0)
key = 'csv_cache'

if r.exists(key):
    print("Loaded from Redis:", json.loads(r.get(key)))
else:
    with open('data.csv') as f:
        reader = csv.DictReader(f)
        rows = list(reader)
        r.set(key, json.dumps(rows), ex=60)
        print("Loaded from CSV and cached:", rows)

ğŸ”¹ Q10 Lambda storing to Redis
import redis, json

r = redis.Redis(host='my-redis-host', port=6379, db=0)

def lambda_handler(event, context):
    # event: {"user": "123", "data": "something"}
    user = event['user']
    data = event['data']
    r.set(user, json.dumps(data), ex=300)
    return {"status": "stored"}
